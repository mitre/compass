<div id="compassPage">
    <div>
        <div>
            <h2>Compass<sub class="is-size-7 pl-1">find your way</sub></h2>
        </div>
        <p>Generate a layer file for any adversary, which you can overlay on the matrix below
            <b>OR</b> Create an adversary in the matrix, then
            upload the layer file to generate an adversary to use in an operation</p>
    </div>
    <hr>
    <div>
        <div class="is-flex is-flex-direction-row mb-4">
            <div class="is-flex is-flex-direction-column">
                <label for="layer-selection-adversary" class="pb-2 is-size-6">Generate Layer</label>
                <div class="is-flex is-flex-direction-row is-align-items-center">
                    <div id="layerSelectionAdversary" class="mt-1 mr-2">
                        <select id="layer-selection-adversary">
                            <option value="" selected>Select an Adversary (All)</option>
                            {% for adv in adversaries %}
                            <option value="{{ adv.adversary_id }}">{{ adv.name }}</option>
                            {% endfor %}}
                        </select>
                    </div>
                    <label for="generateLayer">
                        <button id="generateLayer" class="button is-primary is-small"
                                onclick="generateLayer()">
                            <span class="has-tooltip-multiline has-tooltip-bottom"
                                  data-tooltip="Click 'Generate Layer'. Click '+' to open a new tab in the navigator. Select 'Open Existing Layer'. Select 'Upload from local' and upload the generated layer file.">Generate Layer
                            </span>
                        </button>
                    </label>
                </div>
            </div>
            <div class="is-flex is-flex-direction-column ml-6">
                <label for="generateAdversary" class="pb-2 is-size-6">Generate Adversary</label>
                <div class="is-flex is-flex-direction-row">
                    <label for="generateAdversary">
                        <button id="generateAdversary" class="button is-primary is-small"
                                onclick="uploadAdversaryLayerButtonFileUpload()"><i class="pr-1 fas fa-upload"></i>
                            <span class="has-tooltip-multiline has-tooltip-bottom"
                                  data-tooltip=" Select Techniques: Right Click and 'add to selection. Once all techniques are selected, change the score (bar chart under 'technique controls' to a positive number. Select 'download layer as json' under layer control. Upload Adversary Layer file. The Adversary will now be available to use in an operation. The Adversary will be take on the name of the layer tab. The adversary will be split into phases by tactic.">Create Operation
                            </span>
                        </button>
                    </label>
                    <input id='adversaryLayerInput' type='file' hidden/>
                </div>
            </div>
        </div>
    </div>
    <div>
        <iframe src="https://mitre-attack.github.io/attack-navigator/enterprise/" class="frame">
        </iframe>
    </div>
</div>

<div id="create-adversary-modal-compass" class="modal">
    <div class="modal-content">
        <div class="container">
            <div class="row duk-modal">
            <span onclick="document.getElementById('create-adversary-modal-compass').style.display='none'" class="close"
                  title="Close Modal">&times;</span>
                <div class="column" style="flex:92%">
                    <p style="color: white"></p>
                    <div style="background-color: var(--primary-background);padding: 15px;border-radius: 25px">
                        <h3>Adversary Created</h3>
                        <h2 id="adversary-create-name"></h2>
                        <div id="adversary-create-response"></div>
                        <br>
                        <div id="missing-abilities" style="align-content:center; display: none;">
                            <h2>Missing Abilities</h2>
                            <table class="display dataTable no-footer compact" id="missing-abilities-table"
                                   align="center" style="width:75%; color: white; text-align: left;">
                                <thead>
                                <tr>
                                    <th id="missing-abilities-tactic">Tactic</th>
                                    <th id="missing-abilities-technique">Technique ID</th>
                                </tr>
                                </thead>
                                <tbody id="missing-abilities-body">
                                </tbody>
                            </table>
                        </div>
                        <br>
                    </div>
                    <p class="has-text-centered">An adversary is only as good as its abilities. APT layers will
                        cover the same tactics and techniques. Procedures that accurately represent an APT only
                        come from proper curation of an adversary.</p>
                    <button class="button-success atomic-button" style="width: 50%"
                            onclick="document.getElementById('create-adversary-modal-compass').style.display='none'">
                        Close
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="/compass/js/compass.js"></script>
<style>
    #compassPage .frame {
        display: flex;
        width: 100%;
        border-radius: 5px;
        overflow: auto;
        height: 900px;
        border: 2px solid #666666;
    }
</style>
